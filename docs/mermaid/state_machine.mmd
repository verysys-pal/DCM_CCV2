%%{init: {"theme":"base","themeVariables":{
"background":"#ffffff",
"primaryTextColor":"#111111"
}}}%%

%% Operating state machine (Bridge + OperatingLogic)
stateDiagram-v2
  [*] --> OFF
  %% START + MODE drives initial state
  OFF --> WARMUP: START + MODE=WARM_UP
  OFF --> INIT: START (other modes)
  INIT --> PRECOOL: after init_seconds
  PRECOOL --> RUN: Tch <= (Tsp - precool_band)
  RUN --> HOLD: CMD.HOLD
  HOLD --> RUN: CMD.RESUME
  any --> OFF: CMD.STOP or CMD.OFF
  SAFE_SHUTDOWN --> OFF: CMD.RESET
  WARMUP --> OFF: Tch >= (Tamb - precool_band)

  state any {
    [*] --> [*]
  }
